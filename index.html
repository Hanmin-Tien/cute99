<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">

<!-- 
    â˜… é—œéµä¿®æ”¹ 1ï¼šViewport è¨­å®š 
    é€™è¡Œä»£ç¢¼å‘Šè¨´ç€è¦½å™¨ï¼š
    1. width=device-width: ç¶²é å¯¬åº¦ç­‰æ–¼è£ç½®è¢å¹•å¯¬åº¦
    2. initial-scale=1.0: åˆå§‹ç¸®æ”¾æ¯”ä¾‹ç‚º 1:1
    3. user-scalable=no: ç¦æ­¢ä½¿ç”¨è€…ç¸®æ”¾ï¼ˆé˜²æ­¢ç©éŠæˆ²æ™‚ä¸å°å¿ƒé›™æ“Šæ”¾å¤§ï¼‰
-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>å¯æ„›99ä¹˜æ³•éŠæˆ²</title>

<style>
/* ===============================
   å…¨åŸŸæ¨£å¼è¨­å®š
================================ */
body {
  margin: 0;
  padding: 0;
  font-family: "Comic Sans MS", "å¾®è»Ÿæ­£é»‘é«”", sans-serif; /* åŠ å…¥ä¸­æ–‡å­—é«”å‚™æ¡ˆ */
  background: linear-gradient(#ffe6f0, #fff);
  text-align: center;
  
  /* è®“å…§å®¹å‚ç›´ç½®ä¸­ (é˜²æ­¢æ‰‹æ©Ÿç•«é¢éé•·) */
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center; 
  
  /* é˜²æ­¢æ‰‹æ©Ÿé»æ“Šæ™‚çš„é«˜äº®è—è‰²èƒŒæ™¯ */
  -webkit-tap-highlight-color: transparent;
}

h2 {
  margin: 10px 0;
  font-size: 1.5rem; /* ä½¿ç”¨ rem å–®ä½ï¼Œéš¨è¢å¹•ç¸®æ”¾ */
}

/* ===============================
   è§’è‰²å€å¡Š
================================ */
#girl {
  width: 140px;
  max-width: 40%; /* â˜… ä¿®æ”¹ï¼šæ‰‹æ©Ÿè¢å¹•è¼ƒå°æ™‚ï¼Œåœ–ç‰‡ä¸æœƒè¶…éè¢å¹• 40% */
  height: auto;
  margin: 10px auto;
  transition: transform 0.3s;
}

/* å‹•ç•«å®šç¾©ä¿æŒä¸è®Š */
.jump { animation: jump 0.4s; }
.shake { animation: shake 0.4s; }
.dance { animation: dance 0.6s infinite; }

@keyframes jump {
  0% { transform: translateY(0); }
  50% { transform: translateY(-30px); }
  100% { transform: translateY(0); }
}

@keyframes shake {
  0% { transform: rotate(0); }
  25% { transform: rotate(-10deg); }
  50% { transform: rotate(10deg); }
  75% { transform: rotate(-10deg); }
  100% { transform: rotate(0); }
}

@keyframes dance {
  0% { transform: rotate(0) translateY(0); }
  25% { transform: rotate(-10deg) translateY(-10px); }
  50% { transform: rotate(10deg) translateY(0); }
  75% { transform: rotate(-10deg) translateY(-10px); }
  100% { transform: rotate(0) translateY(0); }
}

/* ===============================
   éŠæˆ²è³‡è¨Šèˆ‡æ§åˆ¶å€
================================ */
.info-bar {
  font-size: 1.2rem;
  margin: 10px 0;
}

select {
  font-size: 1rem;
  padding: 5px;
  margin-top: 5px;
}

/* ===============================
   é¡Œç›®æ‰è½å€
================================ */
#number {
  font-size: 3.5rem; /* ä½¿ç”¨ç›¸å°å–®ä½ï¼Œæ‰‹æ©Ÿä¸Šä¸æœƒéå¤§ */
  margin: 15px;
  font-weight: bold;
  color: #ff69b4;
}

/* ===============================
   é¸é …æŒ‰éˆ•å€ (Flexbox æ’ç‰ˆ)
================================ */
#choices {
  display: flex;           /* å•Ÿç”¨å½ˆæ€§ç›’æ¨¡å‹ */
  flex-wrap: wrap;         /* å…è¨±æ›è¡Œ */
  justify-content: center; /* æ°´å¹³ç½®ä¸­ */
  gap: 15px;               /* æŒ‰éˆ•ä¹‹é–“çš„é–“è· */
  width: 90%;              /* å®¹å™¨å¯¬åº¦ä½”è¢å¹• 90% */
  max-width: 400px;        /* æœ€å¤§ä¸è¶…é 400px */
}

/* é¸é …æŒ‰éˆ•æ¨£å¼ */
.choice {
  font-size: 1.5rem;
  padding: 15px 0;         /* å¢åŠ å‚ç›´ padding è®“æ‰‹æŒ‡å¥½é» */
  width: 45%;              /* â˜… ä¿®æ”¹ï¼šæ¯å€‹æŒ‰éˆ•ä½”å¯¬åº¦ 45%ï¼Œé€™æ¨£ä¸€è¡Œæœƒé¡¯ç¤ºå…©å€‹ */
  border-radius: 20px;
  border: 2px solid #fff;
  background: #ffb6c1;
  color: #fff;
  cursor: pointer;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  transition: transform 0.1s;
  
  /* ç¦æ­¢æ‰‹æ©Ÿé•·æŒ‰é¸å–æ–‡å­— */
  user-select: none; 
}

/* æŒ‰éˆ•æŒ‰ä¸‹æ™‚çš„æ•ˆæœ */
.choice:active {
  transform: scale(0.95);
  background: #ff91a4;
}

#message {
  margin-top: 20px;
  font-size: 1.5rem;
  font-weight: bold;
  color: #d63384;
  height: 30px; /* é ç•™é«˜åº¦é˜²æ­¢è·³å‹• */
}
</style>
</head>

<body>

<h2>ğŸ€ 99 ä¹˜æ³•å¯æ„›æŒ‘æˆ° ğŸ€</h2>

<!-- ç¢ºä¿åœ–ç‰‡è·¯å¾‘æ­£ç¢ºï¼Œè‹¥ç„¡åœ–ç‰‡æœƒé¡¯ç¤º alt æ–‡å­— -->
<img id="girl" src="girl.png" alt="éŠæˆ²è§’è‰²">

<div class="info-bar">
  åˆ†æ•¸ï¼š<span id="score">300</span> |
  æ™‚é–“ï¼š<span id="time">60</span>
</div>

<!-- é›£åº¦é¸æ“‡ -->
<select id="level">
  <option value="5">ç°¡å–® (5ä»¥å…§)</option>
  <option value="9" selected>æ™®é€š (9ä»¥å…§)</option>
</select>

<!-- é¡Œç›®é¡¯ç¤ºå€ -->
<div id="number"></div>

<!-- é¸é …æŒ‰éˆ•å®¹å™¨ -->
<div id="choices"></div>

<!-- è¨Šæ¯é¡¯ç¤ºå€ -->
<div id="message"></div>

<script>
/* ===============================
   åŸºæœ¬è®Šæ•¸ç‹€æ…‹è¨­å®š
================================ */
let score = 300;
let time = 60;
let correctAnswer = "";
let gameOver = false;
let timer;

/* ===============================
   éŸ³æ•ˆè¼‰å…¥ (ç¢ºä¿æª”æ¡ˆå­˜åœ¨)
================================ */
const sounds = {
  correct: new Audio("correct.mp3"),
  wrong: new Audio("wrong.mp3"),
  win: new Audio("win.mp3")
};

/* ===============================
   è§’è‰²å‹•ç•«å·¥å…·å‡½å¼
================================ */
const girl = document.getElementById("girl");

function playAnimation(type) {
  // ç§»é™¤æ‰€æœ‰å‹•ç•« class
  girl.className = "";
  
  // å¼·åˆ¶ç€è¦½å™¨é‡ç¹ª (Reflow)ï¼Œè®“å‹•ç•«å¯ä»¥é‡è¤‡è§¸ç™¼
  void girl.offsetWidth; 
  
  // åŠ å…¥æ–°çš„å‹•ç•« class
  girl.classList.add(type);
}

/* ===============================
   å€’æ•¸è¨ˆæ™‚å™¨
================================ */
function startTimer() {
  // æ¸…é™¤èˆŠçš„è¨ˆæ™‚å™¨ (é˜²æ­¢é‡è¤‡å•Ÿå‹•)
  if(timer) clearInterval(timer);
  
  timer = setInterval(() => {
    time--;
    document.getElementById("time").textContent = time;
    if (time <= 0) endGame("æ™‚é–“åˆ° â°");
  }, 1000);
}

/* ===============================
   æ ¸å¿ƒé‚è¼¯ï¼šå‡ºé¡Œ
================================ */
function randomQuestion() {
  if (gameOver) return;

  // æ¸…ç©ºé¸é …å€åŸŸ
  const choicesDiv = document.getElementById("choices");
  choicesDiv.innerHTML = "";
  document.getElementById("message").textContent = ""; // æ¸…ç©ºè¨Šæ¯

  // å–å¾—ç•¶å‰é›£åº¦
  let max = parseInt(document.getElementById("level").value);
  
  // ç”¢ç”Ÿé¡Œç›® (A * B)
  let a = Math.floor(Math.random() * max) + 1;
  let b = Math.floor(Math.random() * max) + 1;

  // è¨­å®šæ­£ç¢ºç­”æ¡ˆèˆ‡é¡¯ç¤ºé¡Œç›®
  // æ³¨æ„ï¼šé€™è£¡é¡Œç›®é¡¯ç¤ºçš„æ˜¯ç© (Product)ï¼Œé¸é …æ˜¯å› å­ (Factors)
  // å¦‚æœä½ æƒ³é¡¯ç¤ºé¡Œç›®æ˜¯ "2 x 3 = ?", é¸é …æ˜¯ "6"ï¼Œè«‹åƒè€ƒä¸‹æ–¹é‚è¼¯èª¿æ•´
  // æ ¹æ“šä½ åŸæœ¬çš„ä»£ç¢¼ï¼Œé¡Œç›®é¡¯ç¤ºçš„æ˜¯ "ç­”æ¡ˆ(æ•¸å­—)"ï¼Œé¸é …é¡¯ç¤ºçš„æ˜¯ "ç®—å¼"
  
  correctAnswer = `${a} Ã— ${b}`;  // æ­£ç¢ºçš„ç®—å¼å­—ä¸²
  document.getElementById("number").textContent = a * b; // é¡¯ç¤ºä¹˜ç©

  // ç”¢ç”Ÿé¸é … (ä½¿ç”¨ Set é¿å…é‡è¤‡)
  let answers = new Set([correctAnswer]);
  
  // è£œæ»¿åˆ° 4 å€‹é¸é … (æ‰‹æ©Ÿç‰ˆ 4 å€‹æ¯”è¼ƒå‰›å¥½ï¼Œè‹¥è¦ 5 å€‹å¯è‡ªè¡Œæ”¹å›)
  while (answers.size < 4) {
    let x = Math.floor(Math.random() * max) + 1;
    let y = Math.floor(Math.random() * max) + 1;
    // é€™è£¡å¯èƒ½ç”¢ç”Ÿä¸åŒç®—å¼ä½†ç­”æ¡ˆç›¸åŒçš„ç‹€æ³ (ä¾‹å¦‚ 2x3 å’Œ 3x2)ï¼Œé€™åœ¨æ•¸å­¸éŠæˆ²ä¸­æ˜¯åˆç†çš„å¹²æ“¾é …
    answers.add(`${x} Ã— ${y}`);
  }

  // å°‡é¸é …æ‰“äº‚ä¸¦å»ºç«‹æŒ‰éˆ•
  [...answers].sort(() => Math.random() - 0.5).forEach(ans => {
    let btn = document.createElement("button");
    btn.className = "choice";
    btn.textContent = ans; // æŒ‰éˆ•å…§å®¹
    
    // åŠ å…¥é»æ“Šäº‹ä»¶ (æ”¯æ´è§¸æ§)
    btn.onclick = () => checkAnswer(ans);
    
    choicesDiv.appendChild(btn);
  });
}

/* ===============================
   æ ¸å¿ƒé‚è¼¯ï¼šæª¢æŸ¥ç­”æ¡ˆ
================================ */
function checkAnswer(ans) {
  if (gameOver) return;

  if (ans === correctAnswer) {
    score += 100;
    // å˜—è©¦æ’­æ”¾éŸ³æ•ˆ (éœ€ä½¿ç”¨è€…èˆ‡ç¶²é äº’å‹•å¾Œæ‰èƒ½æ’­æ”¾)
    try { sounds.correct.currentTime = 0; sounds.correct.play(); } catch(e){}
    playAnimation("jump");
    document.getElementById("message").textContent = "ç­”å°äº†ï¼ğŸ‘";
  } else {
    score -= 50; // æ‰£åˆ†ç¨å¾®æ¸›å°‘ä¸€é»ï¼Œå°å°æœ‹å‹å‹å–„äº›
    try { sounds.wrong.currentTime = 0; sounds.wrong.play(); } catch(e){}
    playAnimation("shake");
    document.getElementById("message").textContent = "å†è©¦è©¦çœ‹ ğŸ’ª";
  }

  document.getElementById("score").textContent = score;

  // åˆ¤æ–·è¼¸è´æ¢ä»¶
  if (score >= 1000) { // ä¿®æ”¹é€šé—œåˆ†æ•¸ï¼Œé¿å…ç©å¤ªä¹…
    try { sounds.win.play(); } catch(e){}
    playAnimation("dance");
    endGame("é€šé—œæˆåŠŸ ğŸ‰");
  } else if (score <= 0) {
    endGame("å¤±æ•—äº† ğŸ˜­");
  } else {
    // ç­”é¡Œå¾Œç¨å¾®å»¶é²å†å‡ºä¸‹ä¸€é¡Œ
    setTimeout(randomQuestion, 500);
  }
}

/* ===============================
   éŠæˆ²çµæŸè™•ç†
================================ */
function endGame(msg) {
  gameOver = true;
  clearInterval(timer);
  document.getElementById("message").textContent = msg;
  document.getElementById("choices").innerHTML = '<button class="choice" onclick="location.reload()" style="width:80%">é‡æ–°é–‹å§‹</button>';
}

/* ===============================
   ç¨‹å¼é€²å…¥é»
================================ */
// ç›£è½é›£åº¦è®ŠåŒ–ï¼Œæ”¹è®Šæ™‚é‡ç½®éŠæˆ² (é¸ç”¨)
document.getElementById("level").addEventListener("change", () => {
    // é€™è£¡ç°¡å–®è™•ç†ï¼šé›£åº¦æ”¹è®Šç›´æ¥é‡æ•´é é¢ï¼Œæˆ–è€…ä½ å¯ä»¥å¯«é‡ç½®é‚è¼¯
    location.reload();
});

// å•Ÿå‹•éŠæˆ²
startTimer();
randomQuestion();

</script>

</body>
</html>
