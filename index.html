<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>å¯æ„›99ä¹˜æ³•éŠæˆ²</title>

<style>
body {
  margin: 0;
  font-family: "Comic Sans MS";
  background: linear-gradient(#ffe6f0, #fff);
  text-align: center;
}

/* ====== è§’è‰² ====== */
#girl {
  width: 140px;
  margin: 10px auto;
  transition: transform 0.3s;
}

/* ç­”å°ï¼šè·³ä¸€ä¸‹ */
.jump {
  animation: jump 0.4s;
}

/* ç­”éŒ¯ï¼šæ–é ­ */
.shake {
  animation: shake 0.4s;
}

/* é€šé—œï¼šè·³èˆ */
.dance {
  animation: dance 0.6s infinite;
}

@keyframes jump {
  0% { transform: translateY(0); }
  50% { transform: translateY(-30px); }
  100% { transform: translateY(0); }
}

@keyframes shake {
  0% { transform: rotate(0); }
  25% { transform: rotate(-10deg); }
  50% { transform: rotate(10deg); }
  75% { transform: rotate(-10deg); }
  100% { transform: rotate(0); }
}

@keyframes dance {
  0% { transform: rotate(0) translateY(0); }
  25% { transform: rotate(-10deg) translateY(-10px); }
  50% { transform: rotate(10deg) translateY(0); }
  75% { transform: rotate(-10deg) translateY(-10px); }
  100% { transform: rotate(0) translateY(0); }
}

/* ====== æ‰è½å€ ====== */
#number {
  font-size: 60px;
  margin: 20px;
}

/* ====== é¸é … ====== */
.choice {
  font-size: 22px;
  margin: 8px;
  padding: 12px 20px;
  border-radius: 20px;
  border: none;
  background: #ffb6c1;
}
</style>
</head>

<body>

<h2>ğŸ€ 99 ä¹˜æ³•å¯æ„›æŒ‘æˆ° ğŸ€</h2>

<img id="girl" src="girl.png">

<div>
  åˆ†æ•¸ï¼š<span id="score">300</span> |
  æ™‚é–“ï¼š<span id="time">60</span>
</div>

<select id="level">
  <option value="5">ç°¡å–®</option>
  <option value="9">æ™®é€š</option>
</select>

<div id="number"></div>
<div id="choices"></div>
<div id="message"></div>

<script>
/* ===============================
   åŸºæœ¬ç‹€æ…‹
================================ */
let score = 300;
let time = 60;
let correctAnswer = "";
let gameOver = false;
let timer;

/* ===============================
   éŸ³æ•ˆ
================================ */
const sounds = {
  correct: new Audio("correct.mp3"),
  wrong: new Audio("wrong.mp3"),
  win: new Audio("win.mp3")
};

/* ===============================
   è§’è‰²å‹•ç•«å·¥å…·
================================ */
const girl = document.getElementById("girl");

function playAnimation(type) {
  girl.className = "";
  void girl.offsetWidth; // å¼·åˆ¶é‡æ’­å‹•ç•«
  girl.classList.add(type);
}

/* ===============================
   å€’æ•¸è¨ˆæ™‚
================================ */
function startTimer() {
  timer = setInterval(() => {
    time--;
    document.getElementById("time").textContent = time;
    if (time <= 0) endGame("æ™‚é–“åˆ° â°");
  }, 1000);
}

/* ===============================
   å‡ºé¡Œ
================================ */
function randomQuestion() {
  if (gameOver) return;

  document.getElementById("choices").innerHTML = "";

  let max = document.getElementById("level").value;
  let a = Math.floor(Math.random() * max) + 1;
  let b = Math.floor(Math.random() * max) + 1;

  correctAnswer = `${a} Ã— ${b}`;
  document.getElementById("number").textContent = a * b;

  let answers = new Set([correctAnswer]);
  while (answers.size < 5) {
    let x = Math.floor(Math.random() * max) + 1;
    let y = Math.floor(Math.random() * max) + 1;
    answers.add(`${x} Ã— ${y}`);
  }

  [...answers].sort(() => Math.random() - 0.5).forEach(ans => {
    let btn = document.createElement("button");
    btn.className = "choice";
    btn.textContent = ans;
    btn.onclick = () => checkAnswer(ans);
    document.getElementById("choices").appendChild(btn);
  });
}

/* ===============================
   æª¢æŸ¥ç­”æ¡ˆ
================================ */
function checkAnswer(ans) {
  if (gameOver) return;

  if (ans === correctAnswer) {
    score += 100;
    sounds.correct.play();
    playAnimation("jump");
  } else {
    score -= 100;
    sounds.wrong.play();
    playAnimation("shake");
  }

  document.getElementById("score").textContent = score;

  if (score >= 1300) {
    sounds.win.play();
    playAnimation("dance");
    endGame("é€šé—œæˆåŠŸ ğŸ‰");
  } else if (score <= 0) {
    endGame("å¤±æ•—äº† ğŸ˜­");
  } else {
    setTimeout(randomQuestion, 400);
  }
}

/* ===============================
   çµæŸ
================================ */
function endGame(msg) {
  gameOver = true;
  clearInterval(timer);
  document.getElementById("message").textContent = msg;
}

/* ===============================
   å•Ÿå‹•
================================ */
startTimer();
randomQuestion();
</script>

</body>
</html>
