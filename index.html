<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>å¯æ„›99ä¹˜æ³•éŠæˆ²</title>

<style>
body {
  margin: 0;
  font-family: "Comic Sans MS", "å¾®è»Ÿæ­£é»‘é«”";
  background: linear-gradient(#ffe0f0, #fff);
  text-align: center;
}

/* ä¸Šæ–¹è³‡è¨Šåˆ— */
#top {
  display: flex;
  justify-content: space-around;
  font-size: 18px;
  padding: 10px;
  color: #ff4f9a;
}

/* è§’è‰² */
#character img {
  width: 120px;
  margin: 10px auto;
}

/* æ‰è½å€ */
#fall-area {
  height: 120px;
  position: relative;
}

#number {
  font-size: 48px;
  background: #fff;
  padding: 15px 30px;
  border-radius: 50%;
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  animation: fall 2s linear;
}

@keyframes fall {
  from { top: -80px; }
  to { top: 40px; }
}

/* é¸é … */
#choices {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
}

.choice {
  width: 45%;
  margin: 8px;
  padding: 15px;
  font-size: 22px;
  border: none;
  border-radius: 25px;
  background: #ffb6d5;
}

#message {
  font-size: 32px;
  margin-top: 15px;
  color: #ff4f9a;
}
</style>
</head>

<body>

<!-- ä¸Šæ–¹ç‹€æ…‹åˆ— -->
<div id="top">
  <div>åˆ†æ•¸ï¼š<span id="score">300</span></div>
  <div>â± <span id="time">60</span>s</div>
  <div>
    é›£åº¦ï¼š
    <select id="level">
      <option value="5">ç°¡å–®</option>
      <option value="7">æ™®é€š</option>
      <option value="9">å›°é›£</option>
    </select>
  </div>
</div>

<!-- è§’è‰² -->
<div id="character">
  <img src="girl.png" alt="girl" />
</div>

<!-- æ‰è½æ•¸å­— -->
<div id="fall-area"></div>

<!-- é¸é … -->
<div id="choices"></div>

<div id="message"></div>

<script>
/* ====== ä½ åŸæœ¬çš„ JSï¼ˆå®Œå…¨ä¿ç•™ï¼‰ ====== */
let score = 300;
let time = 60;
let correctAnswer = "";
let gameOver = false;
let timer = null;

const sounds = {
  correct: new Audio("correct.mp3"),
  wrong: new Audio("wrong.mp3"),
  win: new Audio("win.mp3")
};

function startTimer() {
  timer = setInterval(() => {
    time--;
    document.getElementById("time").textContent = time;
    if (time <= 0) endGame("æ™‚é–“åˆ° â°");
  }, 1000);
}

function randomQuestion() {
  if (gameOver) return;

  document.getElementById("fall-area").innerHTML = "";
  document.getElementById("choices").innerHTML = "";

  let max = document.getElementById("level").value;
  let a = Math.floor(Math.random() * max) + 1;
  let b = Math.floor(Math.random() * max) + 1;

  correctAnswer = `${a} Ã— ${b}`;
  let result = a * b;

  let num = document.createElement("div");
  num.id = "number";
  num.textContent = result;
  document.getElementById("fall-area").appendChild(num);

  let answers = new Set([correctAnswer]);
  while (answers.size < 5) {
    let x = Math.floor(Math.random() * max) + 1;
    let y = Math.floor(Math.random() * max) + 1;
    answers.add(`${x} Ã— ${y}`);
  }

  [...answers].sort(() => Math.random() - 0.5).forEach(ans => {
    let btn = document.createElement("button");
    btn.className = "choice";
    btn.textContent = ans;
    btn.onclick = () => checkAnswer(ans);
    document.getElementById("choices").appendChild(btn);
  });
}

function checkAnswer(ans) {
  if (gameOver) return;

  if (ans === correctAnswer) {
    score += 100;
    sounds.correct.play();
  } else {
    score -= 100;
    sounds.wrong.play();
  }

  document.getElementById("score").textContent = score;

  if (score <= 0) {
    endGame("å¤±æ•—äº† ğŸ˜­");
  } else if (score >= 1300) {
    sounds.win.play();
    endGame("é€šé—œæˆåŠŸ ğŸ‰");
    fireworks();
  } else {
    randomQuestion();
  }
}

function endGame(text) {
  gameOver = true;
  clearInterval(timer);
  document.getElementById("message").textContent = text;
  document.getElementById("choices").innerHTML = "";
}

function fireworks() {
  for (let i = 0; i < 80; i++) {
    let f = document.createElement("div");
    f.className = "firework";
    f.style.left = "50%";
    f.style.top = "50%";
    f.style.setProperty("--x", `${Math.random()*400-200}px`);
    f.style.setProperty("--y", `${Math.random()*400-200}px`);
    document.body.appendChild(f);
    setTimeout(() => f.remove(), 1000);
  }
}

startTimer();
randomQuestion();
</script>

</body>
</html>
